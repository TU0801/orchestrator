# Claudeへの共通ルール

このファイルは全てのClaude（Opus, Sonnet, Claude Code）が従うべきルールを定義する。

## 1. 宇都さんについて

### 状況
- システムエンジニア、複数クライアント向けWeb開発を並行（3-5プロジェクト）
- GCP VM + Claude Code + Supabase + Vercel で開発
- Mac（メイン）、職場Windows（SSH）、スマホ（指示出し）

### 課題（解決したいこと）
- 認知負荷が高い - プロジェクト切り替えのたびに思い出す
- AIのテスターになっている - 動作確認を何度もさせられる
- 指示を書くのが辛い - 長い指示を書かないと正しく動かない
- PCの前に縛られている
- セッションが切れると振り出し

### 望んでいること
- 短い指示で長く正しく動いてほしい
- 朝昼夕夜の4回、スマホから指示を出すだけにしたい
- AIが自律的に作業・テストまでやってほしい
- セッションが切れても続きから再開できる

### コミュニケーションスタイル
- 短い指示で動いてほしい
- 質問攻めNG
- 要点を先に言う
- 宇都さんの要件はころころ変わる（それは当たり前、対応すること）

## 2. 指示を出すときのルール

### 必須項目（絶対に含める）
- **背景**: なぜこれをやるのか、会話の流れ
- **目的**: 何を達成したいか
- **実行者の状態**: 相手は文脈を知っているか？
- **成功条件**: 何ができたら完了か
- **次のステップ**: 完了後に何をするか（デプロイ含む）

### テンプレート

```
## 背景
[この作業に至った経緯]
[今日の会話の要約]
[実行者（Claude Code等）が知っておくべき文脈]

## 目的
[達成したいこと]

## 指示
[具体的な作業内容]

## 成功条件
[何ができたら完了か]
[確認方法]

## 次のステップ
[完了後にやること]
[デプロイが必要か]
```

## 3. 絶対にやってはいけないこと

- 背景なしで作業指示を出す
- 実行者が文脈を知っている前提で話す
- デプロイや動作確認を省略する
- 宇都さんに何度も同じ説明をさせる
- 宇都さんをテスターにする（自分で動作確認してから報告）
- 質問攻めにする

## 4. セッション開始時にやること

新しいセッションを開始したら、まず以下を確認：

1. https://orchestrator-dashboard-six.vercel.app/api/status を読む
2. user_profile で宇都さんの現在の状況を確認
3. projects でアクティブなプロジェクトを確認
4. recent_conversations で直近の会話を確認
5. project_states で各プロジェクトの状態を確認
6. active_tasks で未完了タスクを確認

これを読んでから「続き」として自然に会話を始める。

## 5. 作業終了時にやること

作業が一区切りついたら：

1. 何をやったかを要約
2. 次にやるべきことを提案
3. 重要な決定があれば orch_adrs に記録を依頼
4. 会話が長くなったら orch_conversations に要約を保存

## 6. 7テーブル構造の使い方

| テーブル | 用途 | 更新タイミング |
|---------|------|---------------|
| orch_user_profile | 宇都さんの状況・要件 | 状況が変わったとき |
| orch_projects | プロジェクト基本情報 | 新規追加・変更時 |
| orch_design_docs | 設計ドキュメント | 設計変更時 |
| orch_adrs | 設計判断の記録 | 重要な判断をしたとき |
| orch_conversations | 会話の要約 | 長い会話の終了時 |
| orch_project_states | リアルタイム状態 | 自動（5分ごと） |
| orch_tasks | タスク管理 | タスク追加・完了時 |

## 7. プロジェクト固有ルール

各プロジェクトには CLAUDE.md を配置する。
プロジェクト固有のルール（技術スタック、注意点など）はそちらに記載。

このファイル（CLAUDE_RULES.md）は全プロジェクト共通のルール。
